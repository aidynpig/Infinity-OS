<!DOCTYPE html>
<html>
<head>
    <title>MSDN系统库－致力于原版windows生态服务</title>
    <meta name="keywords" content="系统库,msdn,MSDN系统库,原版系统,原版windows,原版win10,原版win7,原版win8,原版win11,原版office"/>
    <meta name="description" content="MSDN系统库，免费为你提供我告诉你msdn原版纯净系统，原版win11，win10，win8/8.1，win7系统下载，原版office全系列下载与安装等服务"/>
    <meta charset='utf-8'/>
    <meta content="telephone=no" name="format-detection">
    <!--    <meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">-->
    <link rel="shortcut icon" href="https://www.xitongku.com/favicon.ico">
    <link rel="stylesheet" type="text/css" href="https://www.xitongku.com/css/base.css"/>
    <link rel="stylesheet" type="text/css" href="https://www.xitongku.com/css/windows.css"/>
    <link rel="stylesheet" type="text/css" href="https://www.xitongku.com/css/index.css"/>
    <link rel="stylesheet" type="text/css" href="https://www.xitongku.com/css/menu.css"/>
    <link rel="stylesheet" href="https://www.xitongku.com/re_main.css">
    <script type="text/javascript" src="https://www.xitongku.com/js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="https://www.xitongku.com/js/llc.js"></script>
</head>
<body>
<div class="header">
    <div class="logo">
        <a href="/">
            <img src="https://www.xitongku.com/images/logo2.png"/>
        </a>
    </div>
    <div class="close_btn2">
        <div class="icon-left"></div>
        <div class="icon-right"></div>
    </div>
</div>
<div class="box" id="box">
    <div class="left">
        <div class="show_box">
            <div class="show_name">系统库</div>
            <div class="show_desc">MSDN系统库－致力于原版windows生态服务</div>

            <div class="show_img">
                <img id="w_img" src="images/default_windows.png"/>
            </div>
            <div class="show_detail" id="home_desc">
            </div>
            <!--            <div style="clear:both; padding-top:15px; text-align:center; color: #ffffff"><a-->
            <!--                    href="http://beian.miit.gov.cn/"-->
            <!--                    style="color: #ffffff">粤ICP备18149045号</a></div>-->
        </div>
    </div>
    <div class="right">
        <div class="office_btn">
            <a href="office.html" class="function_btn to_office"><div>下载Office</div><img class="down_icon" src="images/ic_download.svg"></a>
        </div>
        <div class="version_box version_content">
            <!--            <div class="form_group">-->
            <!--                <p>请选择系统：<a href="javascript:void(0)" class="tip">?<i style="display: none;">请选择你所需要的Windows</i></a></p>-->
            <!--            </div>-->
            <!--            <div id="windows" class="form_group"></div>-->
            <!--            <div class="form_group">-->
            <!--                <p>请选择版本：<a href="javascript:void(0)" class="tip">?<i>请选择你选择的Windows的版本</i></a></p>-->
            <!--            </div>-->
            <!--            <div id="vision" class="form_group"></div>-->
            <!--                        <div class="form_group">-->
            <!--                            <p>请选择位数：<a href="javascript:void(0)" class="tip">?<i>请选择x86或x64位Windows</i></a></p>-->
            <!--                        </div>-->
            <!--            <div id="bit" class="form_group"></div>-->

        </div>
        <div class="index_footer">
            <div>
                <a href="about.html">关于我们</a>
                <a href="javascript:void(0)" class="tip">微信公众号
                    <i>
                        <img style="width: 200px; height: 200px" src="images/weixin.jpg"/>
                    </i>
                </a>
                <a href="https://hipc.cn/?ku" target="_blank" rel="nofollow">HiPC</a>
                <a href="https://www.haipc.cn/?ku" target="_blank" rel="nofollow">嗨PC主页</a>
                <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow">粤ICP备18149045号</a>
            </div>
        </div>
    </div>
</div>

<div class="dialog" id="dialog">
    <div class="area">
        <h3 class="title" id="dialog_title"></h3>
        <a class="pl_more off" id="dialog_btn"></a>
    </div>
    <div class="bg"></div>
</div>

<div class="content_box" style="display: none;">
    <div class="download_content">
        <div class="left">
            <div class="show_box">
                <div class="show_name">系统库</div>
                <div class="show_desc">MSDN系统库－致力于原版windows生态服务</div>
                <div class="show_img" id="img">
                    <img id="d_img" src="images/win10.png"/>
                </div>
                <div class="show_detail" id="desc">
                </div>
            </div>
        </div>
        <div class="right">
            <div class="office_btn">
<!--                <div class="function_btn to_office"><div>下载Office</div><img class="down_icon" src="images/ic_download.svg"></img></div>-->
            </div>
            <div class="version_box">
                <div class="choose">
                    <!--                    <input type="text" id="system_url" name="add_url" value=""/>-->
                    <!--                    <input type="text" id="vision_url" name="add_url" value=""/>-->
                    <!--                    <input type="text" id="bit_url" name="add_url" value=""/>-->
                    <ul id="edit_view"></ul>
                    <!--                    <input type="text" id="edit_btn" class="edit_btn" value="修改"/>-->
                    <input type="hidden" id="local_url" name="local_url" value=""/>
                </div>
                <div class="tip_title">
                    <div class="download_title">一切为你准备就绪！</div>
                    <p>下载地址</p>
                </div>

                <div id="area_url" class="down_btn"></div>
                <div class="course_btn">
                    <a href="list.html" target="_blank" id="jc_url">安装教程 <img src="images/download_right.png"></a>
                    <a href="soft.html">软件推荐 <img src="images/download_right.png"></a>
                    <a href="javascript:void(0)" class="tip">更新推送
                        <img src="images/download_right.png">
                        <i style="top: -205px;width: unset;left: -80px;">
                            <img style="width: 200px; height: 200px" src="images/weixin.jpg"/>
                        </i>
                    </a>
					<a href="https://hipc.cn/?ku" target="_blank">手机控制电脑 <img src="images/download_right.png"></a>
					<a href="https://www.haipc.cn/?ku" target="_blank">一个好看的主页 <img src="images/download_right.png"></a>
                </div>
            </div>
        </div>

        <span class="clear"></span>
    </div>
</div>
<script type="text/javascript">
    $(function(){
        var MobileUA = (function() {
            var ua = navigator.userAgent.toLowerCase();
            var mua = {
                IOS: /ipod|iphone|ipad/.test(ua), //iOS
                IPHONE: /iphone/.test(ua), //iPhone
                IPAD: /ipad/.test(ua), //iPad
                ANDROID: /android/.test(ua), //Android Device
                WINDOWS: /windows/.test(ua), //Windows Device
                TOUCH_DEVICE: ('ontouchstart' in window) || /touch/.test(ua), //Touch Device
                MOBILE: /mobile/.test(ua), //Mobile Device (iPad)
                ANDROID_TABLET: false, //Android Tablet
                WINDOWS_TABLET: false, //Windows Tablet
                TABLET: false, //Tablet (iPad, Android, Windows)
                SMART_PHONE: false //Smart Phone (iPhone, Android)
            };
            mua.ANDROID_TABLET = mua.ANDROID && !mua.MOBILE;
            mua.WINDOWS_TABLET = mua.WINDOWS && /tablet/.test(ua);
            mua.TABLET = mua.IPAD || mua.ANDROID_TABLET || mua.WINDOWS_TABLET;
            mua.SMART_PHONE = mua.MOBILE && !mua.TABLET;
            return mua;
        }());
        //SmartPhone
        if (MobileUA.SMART_PHONE) {
            // 移动端链接地址
            var moblieUrl= "https://www.xitongku.com/h5/";
            // moblieUrl = moblieUrl.replace("http://iwin10.net", "http://m.iwin10.net");
            // moblieUrl = moblieUrl.replace("//", "//m.");
            document.location.href = moblieUrl;

        }
    });
    let downData;
    $(function () {
        $.ajax({
            type: "get",
            url: "./data/windows.json",
            // url: "http://admin.xitongku.com/api/soft/export_json?type=windows",
            dataType: "json",
            success: function (res) {
                let data = [];
                data.push({children: []})
                data[0].children = convert(res, 0);
                console.log(data)

                let box = $(".version_content")
                let box_div = $("<div id='first'/>")
                box.append(box_div)
                // if (res.length > 0){
                //     // for (let i = 0; i < res.length; i++){
                //     //    let item_title = $("<div class='form_group'>")
                //     //     console.log(box)
                //     //     item_title.append("<p>请选择系统：<a href=\"javascript:void(0)\" class=\"tip\">?<i style=\"display: none;\">请选择你所需要的Windows</i></a></p>")
                //     //     box.append(item_title)
                //     // }
                downData = data[0].children;
                data.forEach((item, i) => {
                    console.log(item)
                    let item_title = $("<div class='form_group'>")
                    item_title.append("<p>请选择系统：</p>")
                    // item_title.append("<p>请选择系统：<a href=\"javascript:void(0)\" class=\"tip\">?<i style=\"display: none;\">请选择你所需要的Windows</i></a></p>")
                    box_div.append(item_title)
                    if (item.children.length > 0) {
                        let select_box = $("<div id='' class=\"form_group\">")
                        let select_ul = $("<ul class=''/>")
                        select_box.append(select_ul)
                        box_div.append(select_box)
                        item.children.forEach((item, ii) => {
                            downItem(item, select_ul, i, [ii])
                        })
                    }
                })
                // }
            }
        })
    })

    function convert(data, pid) {
        let convertData = [];
        data.forEach((item, i) => {
            if (item.pid === pid) {
                convertData.push(item);
                convertChild(data, item, item.id)
            }
        })
        return convertData;
    }

    function convertChild(arr, pItem, pid) {
        pItem.children = pItem.children ? pItem.children : [];
        arr.forEach(item => {
            if (item.pid === pid) {
                pItem.children.push(item);
                convertChild(arr, item, item.id)
            }
        })
        return pItem.children;
    }

    function downItem(item, view, index, for_index) {
        // 把item 存进h5中，后续直接拿数据
        let select_item = $("<li class='off' id='select' data='" + JSON.stringify(item) + "' index='" + for_index.join(",") + "'>" + item.name + "</li>")
        view.append(select_item);
        let box_div;
        //组件存在则复用
        if ($('#a' + index).length > 0) {
            box_div = $('#a' + index)
        } else {
            box_div = $("<div id='a" + index + "' attr='" + item + "'/>")
            box_div.appendTo(".version_content")
        }
        index++;
        if (for_index[for_index.length - 1] == 0) {
            select_item.addClass("on")
        }
        select_item.click(function () {
            //判断上一级是否选中
            if (index - 3 >= 0) {
                if ($('#a' + (index - 3) + " .on").length == 0) {
                    return;
                }
            }
            // index == 2 时判断第一项有没有选中
            if (index == 2 && $("#first .on").length == 0) {
                return;
            }
            //添加选中状态
            $(this).siblings("li").removeClass();
            $(this).addClass("on");
            //清除之前组件的数据;
            box_div.empty();
            for (let box_i = index; box_i < 5; box_i++) {
                $('#a' + box_i).empty();
            }
            //点击时拿当项
            if (item.children.length > 0) {
                if (item.image != ''){
                    $("#w_img").attr('src',item.pc_img);
                }
                if (item.fullname){
                    $(".show_name").text(item.fullname)
                    $(".show_desc").text(item.slogan)
                }
                let item_title = $("<div class='form_group'>")
                // item_title.append("<p>" + item.nickname + "<a href=\"javascript:void(0)\" class=\"tip\">?<i style=\"display: none;\">请选择你所需要的Windows</i></a></p>")
                let item_nickname = $("<p>" + item.nickname + "</p>")
                if (item.annotate){
                    let item_tip = $("<a href=\"javascript:void(0)\" class=\"tip\">?</a>")
                    let item_i = $("<i style=\"display: none;\"></i>")
                    item_i.html("<div>"+item.annotate+"</div>")
                    item_tip.append(item_i)
                    item_nickname.append(item_tip)
                }
                item_title.append(item_nickname)
                box_div.append(item_title)
                let select_box = $("<div id='' class=\"form_group\">")
                let select_ul = $("<ul class=''/>")
                select_box.append(select_ul)
                box_div.append(select_box)
                item.children.forEach((item, ii) => {
                    downItem(item, select_ul, index, for_index.concat(ii))
                })
            } else if (item.children.length == 0) {
                addDownBtn(item, for_index);
            }
        })
        // 非点击时 只拿第一项的子项
        if (item.children.length > 0 && for_index[for_index.length - 1] == 0) {
            if (item.image != ''){
                $("#w_img").attr('src',item.pc_img);
            }
            if (item.fullname){
                $(".show_name").text(item.fullname)
                $(".show_desc").text(item.slogan)
            }
            let item_title = $("<div class='form_group'>")
            let item_nickname = $("<p>" + item.nickname + "</p>")
            if (item.annotate){
                let item_tip = $("<a href=\"javascript:void(0)\" class=\"tip\">?</a>")
                let item_i = $("<i style=\"display: none;\"></i>")
                item_i.html("<div class='tip_content'>"+item.annotate+"</div>")
                item_tip.append(item_i)
                item_nickname.append(item_tip)
            }
            item_title.append(item_nickname)
            box_div.append(item_title)
            // box_div.appendTo(".version_content")
            let select_box = $("<div id='' class=\"form_group\">")
            let select_ul = $("<ul class=''/>")
            select_box.append(select_ul)
            box_div.append(select_box)
            item.children.forEach((item, ii) => {
                downItem(item, select_ul, index, for_index.concat(ii))
            })
        } else if (item.children.length == 0 && for_index[for_index.length - 1] == 0) {
            addDownBtn(item, for_index);
        }

    }

    function addDownBtn(item, for_index) {
        let down_btn;
        if ($("#down_btn").length > 0) {
            $("#down_btn").remove();
        }
        down_btn = $("<div class=\"function_btn btn_down\" id='down_btn' data='" + JSON.stringify(item) + "' index='" + for_index.join(",") + "'><div>下载</div></div>")
        down_btn.appendTo(".version_content")
        $("#home_desc").html(item.description);
    }

    $(document).on("click", "#down_btn", function () {
        let data = JSON.parse($(this).attr('data'));
        let index = $(this).attr('index').split(",");
        if (!data.keywords){
            alert("未找到下载地址");
            return ;
        }
        let down = JSON.parse(data.keywords);
        $("#box").hide();
        $("#desc").html(data.description);
        let item = downData;
        for (let i = 0; i < index.length; i++) {
            let edit_li = $("<li class='select_on' >" + item[index[i]].name + "</li>")
            item = item[index[i]].children
            edit_li.appendTo("#edit_view")
        }
        $("<li class='off' id='edit_btn'>修改</li>").appendTo("#edit_view")
        $("#d_img").attr('src',downData[index[0]].pc_img)
        // console.log(downData[index[0]].image)
        let keys = Object.keys(down)
        $("#area_url").empty();
        for (let i = 0; i < keys.length; i++) {
            let str_url = "";
            if (keys[i].indexOf("|") != -1){
                let key = keys[i].split("|");
                console.log(key)
                str_url = $("<a class='down_list' target='_blank' code='"+key[1]+"' url='"+ down[keys[i]] +"'>" + key[0] + "</a>");
                str_url.click(function (){
                    // console.log($(this).attr('code'))
                    let code = $(this).attr('code');
                    let url = $(this).attr('url')
                    let dialog = $("#dialog");
                    $("#dialog_title").text("提取码："+$(this).attr('code'));
                    $("#dialog_btn").text("复制并跳转下载");
                    $("#dialog_btn").attr("code",code);
                    $("#dialog_btn").attr("url",url);
                    dialog.show();
                })
            }else {
                str_url = $("<a class='down_list' target='_blank' href='"+down[keys[i]]+"'>" + keys[i] + "</a>");
            }
            $("#area_url").append(str_url);
        }
        $(".content_box").show();

    });

    $(".bg").click(function(){
        // $(".link ul li a").attr("class","");
        $("#dialog").hide();
    });
    $("#dialog_btn").click(function (){
        let copy = document.createElement('input');
        copy.setAttribute("id", "cp_hgz_input");
        copy.value =$(this).attr('code');
        document.getElementsByTagName('body')[0].appendChild(copy);
        document.getElementById('cp_hgz_input').select();
        document.execCommand('copy');
        // document.getElementById('cp_hgz_input').remove();
        var child = document.getElementById('cp_hgz_input');
        child.parentNode.removeChild(child);
        window.open($(this).attr('url'))
    })
    // $(document).ready(function() {
    //     $.ajax({
    //         type: "get",
    //         url: "./home.xml", //这里通过设置url属性来获取xml
    //         dataType: "xml",
    //         timeout: 1000, //设定超时
    //         cache: false, //禁用缓存
    //         success: function(xml) {
    //             console.log(xml)
    //             var frag1 = $("<ul class='system'/>");
    //             var frag2 = $("<ul class='vision'/>");
    //             var frag3 = $("<ul class='bit'/>");
    //             $(xml).find("system").each(function(i) {
    //                 vv = $(this).attr("vision");
    //                 frag1.append("<li>" + vv + "</li>");
    //             });
    //             $(xml).find("system:first").each(function(i) {
    //                 classid = $(this).children("classid");
    //                 for (i = 0; i < classid.length; i++) {
    //                     frag2.append("<dd class='off' rel=" + classid.eq(i).text() + ">" + classid.eq(i).attr("name") + "</dd>");
    //                 }
    //             });
    //             $(xml).find("system:first").each(function(i) {
    //                 classid = $(this).children("classid");
    //                 classid_txt = classid.eq(i).text();
    //                 bit_text = classid_txt.split("|");
    //                 for (var i = 0; i < bit_text.length; i++) {
    //                     frag3.append("<dd class='off' >" + bit_text[i] + "</dd>");
    //
    //                 }
    //             });
    //             frag1.appendTo("#windows");
    //             frag2.appendTo("#vision");
    //             frag3.appendTo("#bit");
    //         }
    //     });
    // });
    // $(document).on("click", "#windows li", function() {
    //     $("#bit li").removeClass();
    //     $(this).siblings("li").removeClass();
    //     $(this).addClass("on");
    //     n = $(this).text();
    //     $.ajax({
    //         type: "get",
    //         url: "./home.xml", //这里通过设置url属性来获取xml
    //         dataType: "xml",
    //         timeout: 1000, //设定超时
    //         cache: false, //禁用缓存
    //         success: function(xml) {
    //             $(xml).find("system").each(function(i) {
    //                 vision = $(this).attr("vision");
    //
    //
    //                 classid = $(this).children("classid");
    //                 if (vision == n) {
    //                     w_img = $(this).attr("img");
    //                     w_title = $(this).attr("title");
    //                     $("#w_img").attr('src', w_img);
    //                     $(".show_name").text(vision);
    //                     $(".show_desc").text(w_title);
    //                     var frag = $("<ul class='vision' />");
    //                     for (i = 0; i < classid.length; i++) {
    //                         frag.append("<li rel=" + classid.eq(i).text() + ">" + classid.eq(i).attr("name") + "</li>");
    //                     }
    //                     $("#system_url").val(vision);
    //                 }
    //                 $("#vision").html(frag);
    //             });
    //         }
    //     });
    // });
    // $(document).on("click", "#vision li", function() {
    //     $(this).siblings("li").removeClass();
    //     $(this).addClass("on");
    //     p_text = $(this).attr("rel");
    //     bit_text = p_text.split("|");
    //     var frag = $("<ul class='bit' />");
    //     for (var i = 0; i < bit_text.length; i++) {
    //         frag.append("<li>" + bit_text[i] + "</li>");
    //
    //     }
    //     $("#vision_url").val($(this).text());
    //     $("#bit").html(frag);
    // });
    // $(document).on("click", "#bit li", function() {
    //     $(this).siblings("li").removeClass();
    //     $(this).addClass("on");
    //     // $("#add_url").val($("#add_url").val()+"_"+$(this).text());
    //     $("#bit_url").val($(this).text());
    //
    //     $("#local_url").val($("#system_url").val() + "_" + $("#vision_url").val() + "_" + $("#bit_url").val());
    //     local_url = $("#system_url").val() + "_" + $("#vision_url").val() + "_" + $("#bit_url").val();
    //     $(".box").hide();
    //     $.ajax({
    //         type: "get",
    //         url: "./add_url.xml", //这里通过设置url属性来获取xml
    //         dataType: "xml",
    //         timeout: 1000, //设定超时
    //         cache: false, //禁用缓存
    //         success: function(xml) {
    //             var xxx = $("<ul class='system'/>");
    //             // var xml;
    //             // if (typeof data == "string") {
    //             // 	xml = new ActiveXObject("Microsoft.XMLDOM");
    //             // 	xml.async = false;
    //             // 	xml.loadXML(data);
    //             // } else {
    //             // 	xml = data;
    //             // }
    //
    //             $(xml).find("windows").each(function(i) {
    //                 vision = $(this).attr("vision");
    //                 title = $(this).attr("title");
    //                 $str_url = "";
    //                 if (vision == local_url) {
    //                     vision_title = vision.split("_");
    //                     $("#vision_name").html(vision_title[0]);
    //                     $("#title").html(title);
    //                     $("#img img").attr('src', $(this).children("img").text());
    //                     $("#desc").html($(this).children("desc").html());
    //                     $("#jc_url").attr('href', $(this).children("jc_url").html());
    //                     xxx.appendTo("123");
    //                     down = $(this).children("down");
    //
    //                     for (i = 0; i < down.length; i++) {
    //                         $str_url += ("<a  target='_blank' href='" + down[i].childNodes[0].nodeValue + "'>" + down.eq(i).attr("name") + "</a>");
    //                         // console.log('down[i]', down[i])
    //                         // console.log('路径', down[i].childNodes[0].nodeValue + down.eq(i).attr("name"))
    //
    //                     }
    //                     $("#area_url").html($str_url);
    //                 }
    //             });
    //         }
    //     });
    //     $(".content_box").show();
    //
    // });
    $(document).on("click", "#edit_btn", function () {
        $(".content_box").hide();
        $(".box").show();
        $("#edit_view").empty();
    });
</script>
<!--弹出区域 -->
<div class="menu_area">
    <div class="header">
        <div class="logo">
            <a href="/">
                <img src="images/logo1.png"/>
            </a>
        </div>
        <div class="close_btn open">
            <div class="icon-left"></div>
            <div class="icon-right"></div>
        </div>
    </div>
    <div class="box">
        <div class="content">
            <script type="text/javascript" src="foot_txt.js"></script>
        </div>
    </div>
</div>
<!--弹出区域 -->
		<div style="display:none">
			<script type="text/javascript">
				var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
				document.write(unescape("%3Cspan id='cnzz_stat_icon_1259264936'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol +
					"s11.cnzz.com/stat.php%3Fid%3D1259264936' type='text/javascript'%3E%3C/script%3E"));
			</script>
		</div>
</body>
</html>
